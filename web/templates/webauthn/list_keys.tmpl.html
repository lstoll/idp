{{template "layout.tmpl.html" .}}

{{define "title"}}Webauthn Keys{{end}}

{{define "body"}}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="/public/webauthn.js"></script>
<div>
    <form method="POST">
        {{ csrfField }}
        <input type="hidden" name="action" value="registerKey">
        <input type="submit" value="Register new key">
    </form>
</div>

<div>
    <table>
        <thead>
            <tr>
                <td>Name</td>
                <td>Delete</td>
            </tr>
        </thead>
        {{range $k, $v := .User.Credentials }}
        <tr>
            <td>{{ $k }}</td>
            <td>
                <form method="POST" onsubmit="return confirm('Really remove key {{ $k }}?');">
                    {{ csrfField }}
                    <input type="hidden" name="action" value="delete">
                    <input type="hidden" name="keyName" value="{{ $k }}">
                    <input type="submit" value="Delete">
                </form>
            </td>
        </tr>
        {{end}}
    </table>

</div>


{{end}}
